<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="who&apos;s your daddy?">
<meta property="og:type" content="website">
<meta property="og:title" content="Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:description" content="who&apos;s your daddy?">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Blog">
<meta name="twitter:description" content="who&apos;s your daddy?">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-102257497-2', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?f11380fcb075224d78c5110a02679bd1";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/20/technology/Web新打开窗口方式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rni-L">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/20/technology/Web新打开窗口方式/" itemprop="url">Web 打开新窗口方式</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-20T15:23:23+08:00">
                2017-10-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/教程/" itemprop="url" rel="index">
                    <span itemprop="name">教程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/20/technology/Web新打开窗口方式/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/20/technology/Web新打开窗口方式/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/10/20/technology/Web新打开窗口方式/" class="leancloud_visitors" data-flag-title="Web 打开新窗口方式">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Web-打开新窗口方式"><a href="#Web-打开新窗口方式" class="headerlink" title="Web 打开新窗口方式"></a>Web 打开新窗口方式</h1><blockquote>
<p>之前的项目，有个功能是下载文件，这里只要在浏览器输入 url 就会下载那个文件了。当时我只是简单得使用 <code>window.open</code> ，但是却会被浏览器进行拦截，要手动开启才行，然后就搜索研究其他方法，就看到各种各样的，通过 js 打开新窗口的方法了</p>
</blockquote>
<h2 id="解决下载功能"><a href="#解决下载功能" class="headerlink" title="解决下载功能"></a>解决下载功能</h2><p>这里就先说解决下载功能的方法，通过同事的提醒，改用 iframe 进行处理，直接对 iframe 的 src 进行赋值，就会自动进行下载文件了，不过，如果后端在 response  header 设置了某个头部，就会报错了：x-frame-options: DENY</p>
<p>x-frame-options，是否允许 object 和 iframe 展示，有三个参数：</p>
<ul>
<li>DENY: 即使是相同域名，也不能显示</li>
<li>SAMEORIGIN: 可以在相同域名页面展示</li>
<li>ALLOW-FROM uri: 任何来源都可以展示</li>
</ul>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/X-Frame-Options" target="_blank" rel="external">MDN的解释</a></p>
<p>我的后端同事在要下载的几个接口，添加了 <code>SAMEORIGIN</code> ，最后前端就可以无任何副作用的情况下，通过 js 进行下载文件了</p>
<pre><code>exportOrder: (url) =&gt; {
  // 移除旧的节点
  const oldNode = document.querySelector(&apos;#g-exportOrder-iframe&apos;)
  if (oldNode) {
    document.body.removeChild(document.querySelector(&apos;#g-exportOrder-iframe&apos;))
  }
  // 生成新节点，进行下载
  const iframe = document.createElement(&apos;iframe&apos;)
  iframe.style.display = &quot;none&quot;
  iframe.id = &apos;g-exportOrder-iframe&apos;
  iframe.src = url
  document.body.appendChild(iframe)
}
</code></pre><p>只要调用传个 url ，就会自动下载一个文件了</p>
<h2 id="使用-window-open"><a href="#使用-window-open" class="headerlink" title="使用 window.open"></a>使用 window.open</h2><p>如果我们是点击一个目标，然后同步执行打开窗口操作，用 <code>window.open</code> 是可以的，但是我们把 <code>window.open</code> 放在异步操作里就有问题了</p>
<pre><code>div.addEventListener(&apos;click&apos;, open, false)
function open() {
  setTimeout(() =&gt; {
    window.open(&apos;/api/admin/adslot/all&apos;)
  }, 1100)
}
</code></pre><p>我在谷歌、火狐和欧朋，这样就会被拦截，然而用 ie9 却不会被拦截，我给10秒，ie 最后还是会弹出来</p>
<p>从你用点击事件，到 <code>window.open</code> ，只要异步操作超过某个时间，浏览器就会拦截这个弹窗的操作</p>
<p>如果不添加用户的事件去触发 <code>window.open</code> （比如点击事件，鼠标移入移出等），而是在代码直接运行 <code>window.open</code> 的话，那样浏览器也会拦截</p>
<pre><code>window.onload = function() {
  windon.open()
}
</code></pre><p>总得来讲，如果没有用用户操作的事件去触发 <code>window.open</code> 就会被拦截，而把 <code>window.open</code> 放在异步操作，且超过一定的事件，也会被拦截</p>
<p>这里先想到了解决异步也会被拦截的方法</p>
<pre><code>var test = window.open()
setTimeout(function() {
  test.location = &apos;http://www.xxx.com&apos;
}, 2000)
</code></pre><p>在异步操作前，先打开窗口，然后再在你要操作的位置，更改这个窗口的 <code>location</code> ，不过这个缺陷有点大，要等异步操作完成了，新的窗口才会从空白变到指定页面，而且这种解决不了，没有人为事件触发 <code>window.open</code> 导致被拦截的问题</p>
<h2 id="使用-a-标签"><a href="#使用-a-标签" class="headerlink" title="使用 a 标签"></a>使用 a 标签</h2><p>这是最常见打开一个新标签页面的方法</p>
<pre><code>&lt;a class=&apos;test&apos; href=&apos;http://www.xxx.com&apos; target=&apos;_blank&apos;&gt;&lt;/a&gt;
</code></pre><p>然后，我点击另外一个 div ，再打开新窗口</p>
<pre><code>function open() {
  setTimeout(function() {
    document.querySelector(&apos;.test&apos;).click()
  }, 2000)
}
</code></pre><p>上面的异步操作，还是不行，就算是重新生成一个 a 标签，再用 <code>click()</code> 触发也是不行</p>
<h2 id="form-submit"><a href="#form-submit" class="headerlink" title="form submit"></a>form submit</h2><pre><code>&lt;form class=&apos;test&apos; target=&apos;_blank&apos; @click=&apos;open&apos; method=&apos;GET&apos; action=&apos;http://www.xxx.com&apos;&gt;click me&lt;/form&gt;
function open2() {
  setTimeout(() =&gt; {
    document.querySelector(&apos;.test&apos;).submit()
  }, 2000)
}
</code></pre><p>和 a 标签一样</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>如果要下载文件的话，使用 iframe</p>
<p>如果要打开新窗口，没用用户操作的前提下打开，提示让用户关闭那个拦截吧</p>
<p>用户操作，且是异步的情况下，就使用 <code>window.open</code> ，然后定义 <code>location</code> 这样就好了</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/22/technology/git团队协作流程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rni-L">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/22/technology/git团队协作流程/" itemprop="url">未命名</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-22T23:42:52+08:00">
                2017-09-22
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/09/22/technology/git团队协作流程/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/09/22/technology/git团队协作流程/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/09/22/technology/git团队协作流程/" class="leancloud_visitors" data-flag-title="">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>—<a href="https://zlargon.gitbooks.io/git-tutorial/content/remote/push.html" target="_blank" rel="external">https://zlargon.gitbooks.io/git-tutorial/content/remote/push.html</a><br>title: git团队协作流程<br>date: 2017-09-22 23:42:52<br>tags: git</p>
<h2 id="categories-教程"><a href="#categories-教程" class="headerlink" title="categories: 教程"></a>categories: 教程</h2><h1 id="git团队协作流程"><a href="#git团队协作流程" class="headerlink" title="git团队协作流程"></a>git团队协作流程</h1><blockquote>
<p>这里主要是总结我公司 git 的开发流程，版本的迭代，如何打 tag 等操作</p>
</blockquote>
<h2 id="开发流程"><a href="#开发流程" class="headerlink" title="开发流程"></a>开发流程</h2><p>一个项目的流程，PM 出原型图，主管在 gitlab 建一个仓库，分配权限，分配人手等</p>
<ol>
<li>在 master 初始化一个版本</li>
<li>再 <code>checkout</code> 一个 develop 版本</li>
<li>开发人员，<code>fork</code> 该项目，然后 <code>git clone</code> 到本地</li>
<li>然后要添加源仓库的 origin ，</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/20/recording/log4js的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rni-L">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/20/recording/log4js的使用/" itemprop="url">log4js的使用</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-20T14:55:44+08:00">
                2017-09-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/记录/" itemprop="url" rel="index">
                    <span itemprop="name">记录</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/09/20/recording/log4js的使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/09/20/recording/log4js的使用/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/09/20/recording/log4js的使用/" class="leancloud_visitors" data-flag-title="log4js的使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Nodejs-log4js-的使用"><a href="#Nodejs-log4js-的使用" class="headerlink" title="Nodejs log4js 的使用"></a>Nodejs log4js 的使用</h1><blockquote>
<p>使用log4js，进行日志的管理，方便我们在生产环节进行调试和监控</p>
</blockquote>
<h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><p>导入 <code>log4js</code> 包就行了</p>
<pre><code>npm i log4js -d
// app.js
var log4js = require(&apos;log4js&apos;)
var logger = log4js.getLogger()
logger.debug(&quot;Some debug messages&quot;)
</code></pre><p>上面的 <code>logger.debug()</code> 和 <code>console.log()</code> 使用的方式是一样的，当我们 <code>node app.js</code> 打开服务后，会看到有一条信息打印出来了</p>
<h2 id="Levels"><a href="#Levels" class="headerlink" title="Levels"></a>Levels</h2><p>总共有以下8个级别</p>
<ul>
<li>ALL</li>
<li>FATAL</li>
<li>ERROR</li>
<li>WARN</li>
<li>INFO</li>
<li>DEBUG</li>
<li>TRACE</li>
<li>OFF</li>
</ul>
<h2 id="Category"><a href="#Category" class="headerlink" title="Category"></a>Category</h2><p>设置分类，日志可以进行分类，下面就是一个 test 分类的 logger</p>
<p><code>var logger = log4js.getLogger(&#39;test&#39;)</code></p>
<h2 id="Appender"><a href="#Appender" class="headerlink" title="Appender"></a>Appender</h2><p>打印日志的出口</p>
<pre><code>log4js.configure({
  appenders: [{
    type: &apos;dateFile&apos;, // 文件类型
    filename: &apos;logs/default.log&apos;, // 输出地址
    pattern: &quot;-yyyy-MM-dd&quot;, // 文件输出模式
    alwaysIncludePattern: true // true的话，会模式生成一个新的日志文件
  }]
})
</code></pre><h2 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h2><p>可以过滤掉你不想输出到文件的日志<br>    log4js.configure({<br>      level: ‘DEBUG’, // 低于 DEBUG 级别的日志不过输出到文件<br>      category: ‘c1’ // 只接受 c1 分类的日志，可接受数组<br>    })</p>
<h2 id="backups"><a href="#backups" class="headerlink" title="backups"></a>backups</h2><p>设置备份数量</p>
<pre><code>{
  backups: 7
}
</code></pre><p>只会保留7份日志文件</p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><pre><code>log4js.configure({
  level: &apos;INFO&apos;,
  appenders: [
    { type: &apos;console&apos; }, // 控制台输出
    {
      type: &apos;dateFile&apos;, //文件输出
      filename: &apos;logs/app.log&apos;,
      pattern: &quot;-yyyy-MM-dd&quot;,
      backups: 7,
      category: &apos;http&apos;
    },
    {
      type: &apos;dateFile&apos;, //文件输出
      filename: &apos;logs/error.log&apos;,
      pattern: &quot;-yyyy-MM-dd&quot;,
      backups: 7,
      category: &apos;error&apos;
    }
  ]
})
// 打印相关的信息
app.use(log4js.connectLogger(log4js.getLogger(&apos;http&apos;)))
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/18/technology/canvas图片粒子动画/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rni-L">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/18/technology/canvas图片粒子动画/" itemprop="url">canvas图片粒子动画</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-18T16:51:48+08:00">
                2017-09-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/教程/" itemprop="url" rel="index">
                    <span itemprop="name">教程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/09/18/technology/canvas图片粒子动画/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/09/18/technology/canvas图片粒子动画/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/09/18/technology/canvas图片粒子动画/" class="leancloud_visitors" data-flag-title="canvas图片粒子动画">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="canvas图片粒子化效果的实现"><a href="#canvas图片粒子化效果的实现" class="headerlink" title="canvas图片粒子化效果的实现"></a>canvas图片粒子化效果的实现</h1><blockquote>
<p>这次分享的是 <code>cavans</code> ，通过 <code>js</code> 控制图形、动画的实现。而这次主要是分享粒子动画的实现原理，而不是介绍 <code>canvas</code> 的 <code>api</code> ， <code>api</code> 大家去 <code>MDN</code> 看看就好了</p>
</blockquote>
<h2 id="关键词"><a href="#关键词" class="headerlink" title="关键词"></a>关键词</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial/Basic_usage" target="_blank" rel="external">canvas</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial/Pixel_manipulation_with_canvas" target="_blank" rel="external">ImageData</a></li>
<li><a href="http://www.zhangxinxu.com/wordpress/2013/09/css3-animation-requestanimationframe-tween-%E5%8A%A8%E7%94%BB%E7%AE%97%E6%B3%95/" target="_blank" rel="external">requestAnimationFrame</a></li>
</ul>
<h2 id="相关基础要点"><a href="#相关基础要点" class="headerlink" title="相关基础要点"></a>相关基础要点</h2><h3 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h3><p><code>canvas</code> 的兼容性是支持 <code>ie9</code> ， <code>requestAnimationFrame</code> 的兼容性支持是 <code>ie10</code> 不过 <code>requestAnimationFrame</code> 可以使用 <code>setTimeout</code> 代替</p>
<h3 id="canvas-的坐标系统"><a href="#canvas-的坐标系统" class="headerlink" title="canvas 的坐标系统"></a>canvas 的坐标系统</h3><pre><code>var canvas = document.querySeletor(&apos;canvas&apos;)
canvas.width = 200
canvas.height = 200
</code></pre><p>每个 <code>canavs</code> 的坐标起始点，都是 <code>(0, 0)</code> ，起始点是<strong>左上角</strong></p>
<p><img src="/images/canvas_png1.png" alt=""></p>
<h3 id="获取随机范围值"><a href="#获取随机范围值" class="headerlink" title="获取随机范围值"></a>获取随机范围值</h3><p>这个获取随机范围值，在后面会用到，实现的算法也有多个，这里凑合下</p>
<pre><code>function random(max, min) {
  return Math.ceil(Math.random()*(max-min+1)+min)
}
</code></pre><h2 id="如何使用-canvas"><a href="#如何使用-canvas" class="headerlink" title="如何使用 canvas"></a>如何使用 canvas</h2><pre><code>// 获取 canvas 的上下文
var canvas = document.querySeleteror(&apos;canvas&apos;)
var ctx = canvas.getContext(&apos;2d&apos;)
</code></pre><p><code>.getContext(2d)</code> 这个方法获取一个 <code>2d</code> 的 <code>canvas</code> 的上下文对象，后面的绘制和渲染都要靠 <code>ctx</code> 执行</p>
<p>然后我们就可以使用 <code>ctx</code> 这个上下文进行操作</p>
<pre><code>// 获取一个图片实例
var img = new Image()
// 图片加载完毕后，绘制在 canvas 
img.onload = function() {
  ctx.drawImage(img, 0, 0)
}
// 赋值图片地址
img.src = &apos;./icon/set.png&apos;
</code></pre><p>上面的代码执行后，就会在 <code>canvas</code> 上出现一张图片了。绘制图片的话，一定要等图片加载完毕后，才能执行 <code>canvas</code> 的绘制，不然什么都没有</p>
<h2 id="实现粒子动画"><a href="#实现粒子动画" class="headerlink" title="实现粒子动画"></a>实现粒子动画</h2><p>这里就大概说说实现粒子动画的原理</p>
<p>通俗点，就是多个粒子，在起始位置，去到终点位置，有一个持续性的效果。</p>
<p>我们先要获取两个数据，起始位置和终点位置</p>
<p>而每个粒子都有属于自己的起始位置，终点位置，速度，颜色，大小等属性，也就是说每个粒子都是一个独立的个体</p>
<p>伪代码：</p>
<pre><code>function Create(...){
  this.firstX = x
  this.firstY = y
  this.lastX = lastX
  this.lastY = lastY
  this.rgba = rgba
}

for (var i=0; i&lt; 100; i++) {
  // 生成100个粒子
  new Create()
}
</code></pre><p>为了效果好看，每个粒子的属性都应该是所有区别的</p>
<h3 id="起始位置"><a href="#起始位置" class="headerlink" title="起始位置"></a>起始位置</h3><p>起始位置，这个看需求而定，我这里的效果是从下到上显示的动画效果</p>
<pre><code>function Create() {
  // 水平中间点
  this.x = cW / 2
  // 垂直方向，有一个随机的分布
  this.y = random(cH + 100, cH)
}
</code></pre><h3 id="终点位置"><a href="#终点位置" class="headerlink" title="终点位置"></a>终点位置</h3><p>实现这个粒子动画，最关键的一点就是如何获取每个粒子的终点位置</p>
<p>这里就要使用 <code>ctx.getImageData</code> 这个方法获取图片的<strong>像素数据</strong></p>
<h4 id="ImageData"><a href="#ImageData" class="headerlink" title="ImageData"></a>ImageData</h4><p><code>ImageData</code> 有以下三个<strong>只读</strong>属性</p>
<pre><code>console.log(ctx.getImageData(&apos;2d&apos;))
// ... 打印数据
{
  width: ,
  height: ,
  data: []
}
</code></pre><p>而 <code>data</code> 这个数组不是普通的数组，是一个 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray#兼容性注意事项" target="_blank" rel="external">Uint8ClampedArray</a> 8位无符号整型固定数组，里面的每一个值都是在 [0 - 255] 之间的</p>
<p>使用 <code>getImageData</code> 获取到的数据，其实就是每一个像素点的 <code>rgba</code> 值</p>
<pre><code>var rgba1 = `rgba(${data[0]}, ${data[1]}, ${data[2]}, ${data[3]})`
var rgba2 = `rgba(${data[4]}, ${data[5]}, ${data[6]}, ${data[7]})`
......
</code></pre><p>也就是说，每4位就组成一个像素点的值</p>
<p>而在一个 <code>200 * 200</code> 的 <code>canvas</code> ，通过 <code>getImageData</code> 获取的数据是：</p>
<pre><code>{
  width: 200,
  height: 200,
  data: [160000]
}
</code></pre><p><code>data</code> 的长度就会有16万长，是这样算的： 200 <em> 200 </em> 4</p>
<p>那么我们究竟如何获取到需要的终点位置？</p>
<p>我们要明确一点，这是像素级的操作，每一个点，代表1像素 </p>
<p><img src="/images/canvas_png2.png" alt=""></p>
<p>上面一个圆圈代表1像素，总共有4个像素那么每个像素点的坐标是不是这样：<code>[0, 0], [0, 1], [1, 0], [1, 1]</code></p>
<p>在 <code>200 * 200</code> 的 画布里，就会有4万个像素点</p>
<pre><code>for (var x = 0; x &lt; width; x++) {
  for (var y = 0; y &lt; height; y++) {
    // 这样就能获取到所有像素点的位置
  }
}
</code></pre><p>如果我们让4万个粒子同时在画布里动起来，那肯定会卡死的，我们肯定要进行筛选，获取对我们“有用”的像素点</p>
<h4 id="筛选有用的像素点"><a href="#筛选有用的像素点" class="headerlink" title="筛选有用的像素点"></a>筛选有用的像素点</h4><p><img src="/images/canvas_png3.jpg" alt=""></p>
<p>先看看这张图片，我是在 PS 上进行截图的，除了黑色线，其余都是透明的，我们获取后的 <code>ImageData</code> ，透明的点表现的数值是：(0, 0, 0, 0) 这样的，这对我们根本没用，所以我们可以根据透明度进行筛选像素点</p>
<p>因为 <code>ImageData</code> 是 <code>Uint8ClampedArray</code> ，里面所有的值都是 [0 - 255] 之间的，我们只需要筛选透明度值是 128 以上的像素点就行了</p>
<pre><code>for (var x = 0; x &lt; width; x++) {
  for (var y = 0; y &lt; height; y++) {
    // 筛选
    var i = 4*((y - 1) * width + x)
    if (data[i + 3] &gt;= 128) {
      // ... 获取到坐标和像素值
      {
        x: x,
        y: y,
        rgba: ...
      }
    }
  }
}
</code></pre><p>上面的 <code>var i = 4*((y - 1) * width + x)</code> 这步骤，就是获取这个像素点的索引值</p>
<p>这样获取后的像素点会减少了很多，如果想减少更多的话：</p>
<pre><code>for (var x = 0; x &lt; width; x+= 4) {
  for (var y = 0; y &lt; height; y+= 4) {
  }
}
</code></pre><h3 id="动画效果"><a href="#动画效果" class="headerlink" title="动画效果"></a>动画效果</h3><p>粒子需要的数据都获取到了，然后就是实现动画效果，这里就不详细说了，贴上主要的代码：</p>
<pre><code>// 计算粒子的坐标
function compute(v) {
  if (frames &gt; 120) {
    v.x = v.maxX
    v.y = v.maxY
  }
  return v
}
// 绘制粒子
function drawPoint() {
  // 擦除画布
  ctx.clearRect(0, 0, w, h)
  for(var i=0;i&lt;list.length;i++){
    var v = list[i]
    // 计算
    var _v = compute(v)
    if (_v) {
      v.x = _v.x
      v.y = _v.y
    }
    // 开始路径
    ctx.beginPath()
    ctx.fillStyle = v.rgba
    ctx.arc(v.x, v.y, 1, 0, Math.PI*2, true)
    ctx.fill()
    // 关闭路径
    ctx.closePath()
  }
}
// 运行
function animate() {
  drawPoint()
  if (frames &gt; 120) {
    return false
  }
  frames++
  requestAnimationFrame(animate)
}
animate()
</code></pre><h3 id="requestAnimationFrame"><a href="#requestAnimationFrame" class="headerlink" title="requestAnimationFrame"></a>requestAnimationFrame</h3><p><code>requestAnimationFrame</code> ，现在的浏览器支持的是60帧，也就是说1秒要运行60次，这是最佳的效果。但是当我们<code>js</code>有复杂的运算的话，会达不到这效果，而 <code>requestAnimationFrame</code> 当回调函数完成后，才会触发下一个回调函数，这就是 <code>requestAnimationFrame</code> 优于 <code>setTimeout</code> 的地方。 <code>setTimeout</code> 无论你的回调函数是否在指定时间内完成，只要过了设置的时间，都会执行下一步的回调，从而造成了卡顿的效果</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这次的分享，主要是介绍下 <code>canvas</code> 和普通动画的实现。通过 <code>ImageData</code> 获取到像素点的属性位置等等属性，从而实现粒子动画。 <code>canvas</code> 的功能远远不止这些，能做的事情有很多。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/13/recording/node-canvas的安装和使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rni-L">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/13/recording/node-canvas的安装和使用/" itemprop="url">node-canvas的安装和使用</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-13T15:26:51+08:00">
                2017-09-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/记录/" itemprop="url" rel="index">
                    <span itemprop="name">记录</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/09/13/recording/node-canvas的安装和使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/09/13/recording/node-canvas的安装和使用/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/09/13/recording/node-canvas的安装和使用/" class="leancloud_visitors" data-flag-title="node-canvas的安装和使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="关键词"><a href="#关键词" class="headerlink" title="关键词"></a>关键词</h2><ul>
<li><a href="https://github.com/Automattic/node-canvas/wiki/Installation---Windows" target="_blank" rel="external">node-canvas 官方windows安装教程</a></li>
<li><a href="https://github.com/nodejs/node-gyp#on-windows" target="_blank" rel="external">node-gyp 官方windows安装教程</a></li>
</ul>
<h2 id="windows环境下安装"><a href="#windows环境下安装" class="headerlink" title="windows环境下安装"></a>windows环境下安装</h2><p><code>windows</code> 要使用 <code>node-canvas</code> 的话，要额外安装其他的工具或库来支持的，比如 <code>node-gyp</code> ，而安装 <code>node-gyp</code> 就要安装其他的工具，像 <code>Python2.7</code> ，一定要<strong>2.7</strong>版本，然后VC。</p>
<h3 id="安装-node-gyp"><a href="#安装-node-gyp" class="headerlink" title="安装 node-gyp"></a>安装 <code>node-gyp</code></h3><p>这个现在就很简单了，我在网上看到的教程是以前的，安装的步骤可能比较复杂，而现在只需要一句命令，打开管理员的 <code>cmd</code>，输入 <code>npm install --global --production windows-build-tools</code> ，就会自动安装依赖了，包括 <code>Python</code> 和 <code>vc</code></p>
<h3 id="安装-node-canvas"><a href="#安装-node-canvas" class="headerlink" title="安装 node-canvas"></a>安装 <code>node-canvas</code></h3><p>安装完 <code>node-gyp</code> 后，然后就要安装另外两个依赖， <code>GTK</code> 和 <code>libjpeg-turbo</code> ，这两个都要安装在<strong>C盘</strong>根目录</p>
<p><a href="http://ftp.gnome.org/pub/GNOME/binaries/win64/gtk+/2.22/gtk+-bundle_2.22.1-20101229_win64.zip" target="_blank" rel="external">GTK</a></p>
<p>然后添加环境变量：<code>C:\GTK\bin</code></p>
<p><a href="https://sourceforge.net/projects/libjpeg-turbo/files/1.5.1/" target="_blank" rel="external">libjpeg-turbo</a>，选择 <code>libjpeg-turbo-1.5.1-vc64.exe</code> 这个版本(64位)</p>
<p>最后，在管理员的 <code>cmd</code> 输入 <code>npm i canvas</code> 就完成了</p>
<h2 id="centos环境下安装（待测试）"><a href="#centos环境下安装（待测试）" class="headerlink" title="centos环境下安装（待测试）"></a>centos环境下安装（待测试）</h2><p><code>yum install cairo cairo-devel cairomm-devel libjpeg-turbo-devel pango-devel</code></p>
<p><code>cnpm i node-gyp -g</code></p>
<p><code>cnpm i node-gyp -d</code></p>
<p><code>cnpm i canvas -d</code></p>
<p>完成！</p>
<h3 id="g-not-found"><a href="#g-not-found" class="headerlink" title="g++ not found"></a>g++ not found</h3><pre><code>yum -y update gcc
yum -y install gcc+ gcc-c++
</code></pre><h2 id="node-canvas使用"><a href="#node-canvas使用" class="headerlink" title="node-canvas使用"></a>node-canvas使用</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/11/recording/vue-baidu-map的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rni-L">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/11/recording/vue-baidu-map的使用/" itemprop="url">vue-baidu-map的使用</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-11T23:32:39+08:00">
                2017-09-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/记录/" itemprop="url" rel="index">
                    <span itemprop="name">记录</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/09/11/recording/vue-baidu-map的使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/09/11/recording/vue-baidu-map的使用/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/09/11/recording/vue-baidu-map的使用/" class="leancloud_visitors" data-flag-title="vue-baidu-map的使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="vue-baidu-map的使用"><a href="#vue-baidu-map的使用" class="headerlink" title="vue-baidu-map的使用"></a>vue-baidu-map的使用</h1><blockquote>
<p>vue-baidu-map是百度地图插件封装成vue的一个组件，能让我们更好在vue中使用百度地图的功能</p>
</blockquote>
<p>三个任务： 自定义覆盖物、自定义菜单、画轨迹</p>
<h2 id="关键词"><a href="#关键词" class="headerlink" title="关键词"></a>关键词</h2><ul>
<li><a href="http://lbsyun.baidu.com/index.php?title=jspopular/guide/introduction" target="_blank" rel="external">百度地图</a></li>
<li><a href="https://github.com/Dafrok/vue-baidu-map" target="_blank" rel="external">vue-baidu-map</a></li>
<li>经纬度</li>
<li>百度地图坐标</li>
</ul>
<h2 id="百度地图一些基础知识"><a href="#百度地图一些基础知识" class="headerlink" title="百度地图一些基础知识"></a>百度地图一些基础知识</h2><h3 id="百度api-key"><a href="#百度api-key" class="headerlink" title="百度api key"></a>百度api key</h3><p>使用百度地图前，要有自己的密钥才能使用</p>
<h3 id="坐标（经纬度）"><a href="#坐标（经纬度）" class="headerlink" title="坐标（经纬度）"></a>坐标（经纬度）</h3><p>WGS84 – 通常我们手机和浏览器获取到的gps坐标，是通用类型的坐标系</p>
<p>BD09 – 这是百度地图使用的坐标系</p>
<p>所以我们使用百度地图<code>api</code>以外的方法获取到的经纬度，要经过转换，才能在百度地图上使用，而百度有提供<code>api</code>去转换这个坐标</p>
<p>而且，百度地图大部分的组件，都是需要坐标才能显示</p>
<h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><pre><code>&lt;baidu-map :center=&apos;center&apos; class=&quot;map&quot; ak=&quot;bb1wdmvddqf1Ghaov4lr3txx&quot; @ready=&quot;handler&quot; :zoom=&quot;zoom&quot;  :scroll-wheel-zoom=&quot;true&quot;&gt;&lt;/baidu-map&gt;
// 引入组件
import { BaiduMap } from &apos;vue-baidu-map&apos;
</code></pre><p>像我们平时使用<code>vue</code>组件一样，使用即可，然后一些属性和方法</p>
<p><code>center</code>这个属性，接受一个对象，百度地图显示就会根据经纬度的值进行显示相应的位置。当我们改变<code>center</code>值，百度地图就会相应地改变</p>
<pre><code>// 经纬度
{
  lng: 123,
  lat: 123
}
</code></pre><h3 id="获取百度地图实例"><a href="#获取百度地图实例" class="headerlink" title="获取百度地图实例"></a>获取百度地图实例</h3><p>这里只说明<code>vue</code>组件的</p>
<p>伪代码：</p>
<pre><code>// html
&lt;baidu-map :center=&apos;center&apos; @ready=&quot;handler&quot;&gt;&lt;/baidu-map&gt;

// js
import &apos;baiduMap&apos; from &apos;vue-baidu-map&apos;
// 地图组件初始化，获取实例
handler: function({ BMap }) {
    this.BMap = BMap
}
</code></pre><p>获取了百度地图实例后，就能使用相应的<code>api</code>方法，比如转换<code>gps</code>坐标</p>
<h2 id="自定义覆盖物"><a href="#自定义覆盖物" class="headerlink" title="自定义覆盖物"></a>自定义覆盖物</h2><p>自定义覆盖物功能，传入坐标数据，在地图某个点显示<code>marker</code>和信息窗口</p>
<p>下面大概说下，如何实现点击地图某个位置，显示一个<code>marker</code>和信息窗口</p>
<pre><code>// html
&lt;baidu-map @click=&apos;getClickMapData&apos;&gt;
  &lt;!-- 自定义标记和信息框 --&gt;
  &lt;div v-for=&apos;v, i in markerArr&apos; :key=&apos;v.title&apos;&gt;
    &lt;bm-marker :position=&quot;v.markerPoint&quot; :dragging=&quot;true&quot; :icon=&quot;icon&quot;&gt;&lt;/bm-marker&gt;
    &lt;bm-info-window :position=&quot;v.markerPoint&quot; :title=&quot;v.title&quot; :show=&quot;v.ifShowWindow&quot; &gt;
      &lt;p v-text=&quot;v.contents&quot;&gt;&lt;/p&gt;
    &lt;/bm-info-window&gt;
  &lt;/div&gt;
&lt;/baidu-map&gt;

// js
// 引用bm-marker和bm-info-window组件
import { BmMarker, BmInfoWindow } from &apos;vue-baidu-map&apos;

// 给baidu-map组件添加点击事件，点击地图，获取对应的百度坐标
getClickMapData({ point }) {
  // 添加一个新的对象
  this.markerArr.push({
    markerPoint: point,
    ifShowWindow: false,
    title: &apos;Info Window Title&apos;,
    contents: &apos;1&apos;
  })
}
</code></pre><h2 id="自定义菜单"><a href="#自定义菜单" class="headerlink" title="自定义菜单"></a>自定义菜单</h2><p>在百度地图，显示一个自定义的菜单，有一系列的自定义功能</p>
<pre><code>// html
&lt;bm-control anchor=&apos;BMAP_ANCHOR_TOP_RIGHT&apos; :offset=&apos;{width: 20, height: 20}&apos; class=&apos;map-control&apos;&gt;
  &lt;div class=&quot;map-control-wrap&quot;&gt;
    &lt;div class=&quot;map-control-btnOne map-control-btn&quot; @click=&apos;backInPlace&apos;&gt;回到原位&lt;/div&gt;
    &lt;div class=&quot;map-control-btnTwo map-control-btn&quot; @click=&apos;createAutoMarker&apos;&gt;{{ createMarkerBtnTxt }}&lt;/div&gt;
    &lt;div class=&quot;map-control-btnthr map-control-btn&quot; @click=&quot;addPolyLinePath&quot;&gt;添加路径&lt;/div&gt;
  &lt;/div&gt;
&lt;/bm-control&gt;

// js
import { BmControl } from &apos;vue-baidu-map&apos;
</code></pre><p><code>anchor</code>是显示的位置，有4个选项，左上左下，右上右下。<code>offset</code>是偏离的位置</p>
<p>要实现自定义的功能，就添加事件就好了，比如<code>回到当前位置</code>的功能：</p>
<p>触发点击事件 –&gt;  获取当前gps坐标 –&gt; 转换成百度坐标 –&gt; 更改<code>baidu-map</code>的<code>center</code>值</p>
<h2 id="画轨迹"><a href="#画轨迹" class="headerlink" title="画轨迹"></a>画轨迹</h2><p>使用折线，<code>BmPolyline</code>这个组件，进行画轨迹</p>
<pre><code>// html
&lt;bm-polyline :path=&quot;comPolylinePath&quot; &gt;&lt;/bm-polyline&gt;

//js
data: function() {
  return {
    comPolylinePath: [{
      lat: 123,
      lng: 123
    }]
  }
}
</code></pre><p><code>path</code>接受一个数组，根据这个数组的一个个坐标点，按顺序连接成线</p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p><code>navigator.geolocation.getCurrentPosition</code>使用这个方法可以获取到当前位置坐标，但是这个方法只能在<code>https</code>下才能使用，有个替代方法，使用百度获取位置的<code>api</code>，但只能精确到市的位置</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><code>vue-baidu-map</code>是一个百度地图封装成<code>vue</code>的组件，方便在<code>vue</code>使用</p>
<p>我之前发现了一个<code>bug</code>，使用<code>h5</code>方法获取当前位置的<code>gps</code>坐标，再转换成百度地图坐标，赋值给<code>center</code>，然后点击一些标识，例如商场或者停车场，百度地图会跳转到别的地方去。然后我在<code>github</code>提了个<code>issue</code>，当天就有人解决了这个<code>bug</code>，这个组件还是有人在维护的，效率也挺不错的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/06/technology/nodemailer的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rni-L">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/06/technology/nodemailer的使用/" itemprop="url">nodemailer的使用</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-06T15:21:08+08:00">
                2017-09-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/教程/" itemprop="url" rel="index">
                    <span itemprop="name">教程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/09/06/technology/nodemailer的使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/09/06/technology/nodemailer的使用/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/09/06/technology/nodemailer的使用/" class="leancloud_visitors" data-flag-title="nodemailer的使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>前段时间有个很普通的项目需要发邮件的功能，而且是刚开始学nodejs，所以只是搜索了下用什么好的库能实现，就找到了nodemailer了。这篇文章主要是记录一下使用的过程和经验。</p>
</blockquote>
<h1 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h1><p>这里就先上配置</p>
<p>nodejs: v6.9.4</p>
<p>npm: 3.10.10</p>
<p>nodemailer: ^4.1.0</p>
<pre><code>const params = {
  host: &apos;smtp.163.com&apos;, // 设置服务
  port: 465, // 端口
  sercure: true, // 是否使用TLS，true，端口为465，否则其他或者568
  auth: {
    user: config.user, // 邮箱和密码
    pass: config.emailPwd
  }
}

// 邮件信息
const mailOptions = {
  from: config.user, // 发送邮箱
  to: config.emailTo, // 接受邮箱
  subject: config.title, // 标题
  html: config.html // 内容
}

// 发送邮件
const transporter = nodemailer.createTransport(params)
transporter.sendMail(mailOptions, (error, info) =&gt; {
  if (error) {
    return console.log(error);
  }
  console.log(&apos;Message %s sent: %s&apos;, info.messageId, info.response);
  // success
  // ...
})
</code></pre><p>按照这个格式，发送成功是没什么问题的。不过在<strong>密码</strong>这里要注意，不是邮箱的登录密码。</p>
<h2 id="163和qq获取授权码"><a href="#163和qq获取授权码" class="headerlink" title="163和qq获取授权码"></a>163和qq获取授权码</h2><p>163邮箱的话，要开启POP3/SMTP服务，在设置 –&gt; POP3/SMTP/IMAP页面，设置。开通后会有个授权码的，配置里的密码，就是用这个授权码</p>
<p>qq邮箱的话，同样也要开启这个服务，设置 –&gt; 账户 –&gt; POP3服务，点击开启，就会有个授权码，如果忘了记录，在开启服务下面有个“生成授权码”的，可以获取到的。</p>
<p>这样qq和163就能开启了</p>
<h2 id="Gmail"><a href="#Gmail" class="headerlink" title="Gmail"></a>Gmail</h2><p>如果是Gmail的话，这个就有点麻烦了，在nodemailer官网也有说到：</p>
<p>Gmail either works well or it does not work at all. It is probably easier to switch to an alternative service instead of fixing issues with Gmail. If Gmail does not work for you then don’t use it.</p>
<p>我这里用自己的谷歌邮箱试了下，在上面的配置修改一下</p>
<pre><code>const params = {
  service: &apos;Gmail&apos;, // 注意，host修改为service
  port: 465, // 端口
  sercure: true, // 是否使用TLS，true，端口为465，否则其他或者568
  auth: {
    user: config.user, // 邮箱和密码
    pass: config.emailPwd
  }
}
</code></pre><p>如果这样不行的话，<a href="https://myaccount.google.com/lesssecureapps" target="_blank" rel="external">打开这个链接，开启谷歌允许不够安全应用</a></p>
<p>如果还不行的话，就要配置谷歌的XOAuth2了</p>
<h3 id="配置XOAuth2"><a href="#配置XOAuth2" class="headerlink" title="配置XOAuth2"></a>配置XOAuth2</h3><p>就算使用了这种方法，也未必可能成功</p>
<p><a href="http://masashi-k.blogspot.hk/2013/06/sending-mail-with-gmail-using-xoauth2.html" target="_blank" rel="external">这是我在网上找到的配置XOAuth2的教程</a></p>
<p><a href="https://console.developers.google.com/apis/credentials" target="_blank" rel="external">在这里创建一个凭据</a>，选择OAuth客户端ID，应用类型选择“网页应用”，然后填写名称，重定向URI要记得填写，我填写的是这个”<a href="https://developers.google.com/oauthplayground" target="_blank" rel="external">https://developers.google.com/oauthplayground</a>“</p>
<p><img src="/images/nodemailer1.jpg" alt=""></p>
<p>然后记录下id和密钥</p>
<p><a href="https://developers.google.com/oauthplayground/" target="_blank" rel="external">进入此页面，进行配置</a></p>
<p><img src="/images/nodemailer2.jpg" alt=""></p>
<p>填写之前的id和密钥</p>
<p>然后就是step1，选择api</p>
<p><img src="/images/nodemailer3.jpg" alt=""></p>
<p>到step2，点击’Exchange authorization code for tokens’按钮，生成token，这样就完成了。</p>
<p>回到nodejs，重写下配置</p>
<pre><code>const params = {
  service: &apos;Gmail&apos;,
  auth: {
    type: &apos;OAuth2&apos;,
    user: config.user,
    clientId: config.clientId,
    clientSecret: config.clientSecret,
    refreshToken: config.refreshToken,
    accessToken: config.accessToken
  }
}
</code></pre><p>我这里测试是成功的（本地服务器），如果还不成功的话，这个你只能在搜搜有什么解决方法了。</p>
<p><a href="https://nodemailer.com/smtp/oauth2/" target="_blank" rel="external">这里是官方的OAuth2配置</a></p>
<h1 id="nodemailer其他功能"><a href="#nodemailer其他功能" class="headerlink" title="nodemailer其他功能"></a>nodemailer其他功能</h1><p>这里列出我自己用过的功能，<code>nodemailer</code>看官方介绍，貌似是很多功能的</p>
<h2 id="发送多个用户："><a href="#发送多个用户：" class="headerlink" title="发送多个用户："></a>发送多个用户：</h2><pre><code>// 在配置发送信息的时候
const mailOptions = {
  from: config.user, // 发送邮箱
  to: config.emailTo + &apos;, &apos; + config.emailTo2 // 用&apos;, &apos;分隔
}
</code></pre><h2 id="发送html内容"><a href="#发送html内容" class="headerlink" title="发送html内容"></a>发送html内容</h2><pre><code>const mailOptions = {
  ....
  html: config.html // 这里可以是html字符串
}
</code></pre><h2 id="发送附件"><a href="#发送附件" class="headerlink" title="发送附件"></a>发送附件</h2><p>可以同时发送多个</p>
<pre><code>const mailOptions = {
  ...
  attachments: [{
    filename: &apos;test.txt&apos;,
    content: &apos;hello world!&apos;
  },{
    filename: &apos;test.txt&apos;,
    content: &apos;hello world!&apos;,
    contentType: &apos;text/plain&apos;
  }]
}
</code></pre><p>官方给出的配置</p>
<ul>
<li>filename - filename to be reported as the name of the attached file. Use of unicode is allowed.</li>
<li>content - String, Buffer or a Stream contents for the attachment</li>
<li>path - path to the file if you want to stream the file instead of including it (better for larger attachments)</li>
<li>href – an URL to the file (data uris are allowed as well)</li>
<li>contentType - optional content type for the attachment, if not set will be derived from the filename property</li>
<li>contentDisposition - optional content disposition type for the attachment, defaults to ‘attachment’</li>
<li>cid - optional content id for using inline images in HTML message source</li>
<li>encoding - If set and content is string, then encodes the content to a Buffer using the specified encoding. Example values: ‘base64’, ‘hex’, ‘binary’ etc. Useful if you want to use binary attachments in a JSON formatted email object.</li>
<li>headers - custom headers for the attachment node. Same usage as with message headers</li>
<li>raw - is an optional special value that overrides entire contents of current mime node including mime headers. Useful if you want to prepare node contents yourself</li>
</ul>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>刚使用<code>nodemailer</code>踩了不少坑，弄了我一天，<code>Gmail</code>不怎么稳定，后面主管就叫换成<code>qq</code>了，据说<code>qq</code>企业邮箱发送邮件的次数比较多。这篇文章就是记录下使用<code>nodemailer</code>的一些经验。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/03/recording/你不知道的JavasScript笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rni-L">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/03/recording/你不知道的JavasScript笔记/" itemprop="url">你不知道的JavasScript笔记</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-03T21:59:38+08:00">
                2017-09-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/记录/" itemprop="url" rel="index">
                    <span itemprop="name">记录</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/09/03/recording/你不知道的JavasScript笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/09/03/recording/你不知道的JavasScript笔记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/09/03/recording/你不知道的JavasScript笔记/" class="leancloud_visitors" data-flag-title="你不知道的JavasScript笔记">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>记录读这本书的时候，一些笔记，方便以后再看</p>
</blockquote>
<h1 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h1><h2 id="1-1作用域是什么"><a href="#1-1作用域是什么" class="headerlink" title="1.1作用域是什么"></a>1.1作用域是什么</h2><p>传统编译语言，代码在执行前，会经历三个步骤：</p>
<ol>
<li><p>分词/词法分析</p>
<p>词法分析，会把一段代码分成一个个模块：<code>var a = 1</code>，会被分成<code>var  a  =  1</code></p>
</li>
<li><p>解析/语法分析</p>
<p>将词法单元流（数组）转换成一个由元素组成的树（AST），抽象语法树</p>
<pre><code>|-- Identifier (a)
</code></pre><p> VariableDeclaration -|</p>
<pre><code>|-- AssignmentExpression -|-- 2
</code></pre></li>
<li><p>代码生成</p>
<p>根据语言将AST转换可执行代码</p>
</li>
</ol>
<p>一段代码的执行，需要三个“帮手”，</p>
<ul>
<li><p>引擎</p>
<p>负责整个程序的编译和执行</p>
</li>
<li><p>编译器</p>
<p>负责语法分析和代码生成</p>
</li>
<li><p>作用域</p>
<p>收集和维护所有声明的标识符，按照规定的规则，对标识符是否有访问的权限</p>
</li>
</ul>
<p>变量的赋值操作会执行两个动作，编译器先在当前作用域声明变量，然后再运行时引擎会在作用域查找该变量，如果找到就赋值</p>
<p>编译器在生成代码时，会有两个查询：LHS , RHS</p>
<ul>
<li><p>LHS</p>
<p>LHS查询，会对当前变量在当前作用域查找它本身，找到后就会进行赋值，找不到会从当前作用域往上找，知道找到为止，如果没有，就会生成一个新的变量，并进行赋值。如果操作是非法（对undefiend, null进行赋值，就会报<code>Typeerror</code>错误）</p>
</li>
<li><p>RHS</p>
<p>RHS查询，对目标进行查找并且获取值，先在当前作用域寻找</p>
<p><code>console.log(a)</code>通过RHS查询，获取<code>a</code>的值。如果在所有的作用域都找不到<code>a</code>的话，就会报<code>ReferenceError</code>错误</p>
</li>
</ul>
<p>作用域的查找，会在当前作用域查询，找不到就会一步一步往上找，直到全局作用域。</p>
<h2 id="1-2词法作用域"><a href="#1-2词法作用域" class="headerlink" title="1.2词法作用域"></a>1.2词法作用域</h2><p>看不懂。。。。不要使用<code>eval</code>和<code>with</code></p>
<h2 id="1-3函数作用域和块作用域"><a href="#1-3函数作用域和块作用域" class="headerlink" title="1.3函数作用域和块作用域"></a>1.3函数作用域和块作用域</h2><p><code>function</code>是声明的一个词，就是一个函数声明，否则就是函数表达式</p>
<p>IIFE，立即执行函数表达式</p>
<p>UMD，将运行的函数放在第二位，通过参数导入运行</p>
<p>块作用域</p>
<p><code>let</code>不会再块作用域，声明提升</p>
<pre><code>var a = 1
console.log(a)
obj.addEventListener(&apos;click&apos;, function(e) {
  // ...
}, false)
</code></pre><p>上面代码，打印<code>a</code>后，就没有再引用到<code>a</code>，理论上应该是被回收了。然而<code>click</code>点击事件函数，覆盖了整个作用域的闭包，引擎很有可能会保存这个结构 （这是书中所说的，待考证）</p>
<pre><code>{
  let a = 1
  console.log(a)
}
</code></pre><p>通过块结构，让引擎回收<code>a</code></p>
<h2 id="1-4提升"><a href="#1-4提升" class="headerlink" title="1.4提升"></a>1.4提升</h2><p>先声明，后赋值。使用<code>var</code>和函数声明，都会把变量提升</p>
<p>避免重复声明同一个变量函数</p>
<pre><code>foo() // 1

var foo

function foo() {
  console.log(1)
}

foo = function() {
  console.log(2)
}

------

// 首先foo(1)，然后foo(3)覆盖了foo(1)
foo() //3

function foo() {
  console.log(1)
}

var foo = function() {
  console.log(2)
}

function foo() {
  console.log(3)
}
</code></pre><h1 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h1><h2 id="2-1-关于this"><a href="#2-1-关于this" class="headerlink" title="2.1 关于this"></a>2.1 关于this</h2><p><code>this</code>的上下文，取决于函数调用时的条件，与函数所在的位置无关</p>
<h2 id="2-2-this全面解析"><a href="#2-2-this全面解析" class="headerlink" title="2.2 this全面解析"></a>2.2 this全面解析</h2><p>理解函数调用的位置。首先分析<code>调用栈</code> –&gt; 就是为了到达当前执行位置所调用的所有函数</p>
<pre><code>// 书中例子
function baz() {
  // 调用栈：baz
  // 调用位置： window
  console.log(&apos;baz&apos;)
  bar()
}

function bar(){
  // 调用栈： baz -&gt; bar
  // 调用位置：baz
  console.log(&apos;bar&apos;)
  foo()
}

function foo(){
  // 调用栈： baz -&gt; bar -&gt; foo
  // 调用位置：bar
  console.log(&apos;foo&apos;)
}
</code></pre><p>根据函数执行的区域，判断调用的位置</p>
<p>绑定规则：</p>
<h3 id="默认绑定，在非严格模式下，当function在全局调用，this默认指向window"><a href="#默认绑定，在非严格模式下，当function在全局调用，this默认指向window" class="headerlink" title="默认绑定，在非严格模式下，当function在全局调用，this默认指向window"></a>默认绑定，在非严格模式下，当<code>function</code>在全局调用，<code>this</code>默认指向<code>window</code></h3><h3 id="隐式绑定，根据调用位置的上下文对象，也就是说调用这个function时，的作用域是什么"><a href="#隐式绑定，根据调用位置的上下文对象，也就是说调用这个function时，的作用域是什么" class="headerlink" title="隐式绑定，根据调用位置的上下文对象，也就是说调用这个function时，的作用域是什么"></a>隐式绑定，根据调用位置的上下文对象，也就是说调用这个<code>function</code>时，的作用域是什么</h3><pre><code>function foo() {
  console.log(this.a)
}

var obj = {
  a: 2,
  foo: foo
}

obj.foo() // 2
</code></pre><p>上面代码，调用<code>foo</code>时，是在obj的上下文对象下执行，所以<code>this</code>绑定到<code>obj</code>对象上。对象属性引用链治国在最后一层的调用位置上起作用</p>
<p>隐式绑定有个常见的问题：隐式丢失</p>
<pre><code>function foo() {
  console.log(this.a)
}

var obj = {
  a: 2,
  foo: foo
}

var bar = obj.foo // 引用了foo

var a = &apos;global&apos;

bar() // &apos;global&apos;
</code></pre><p>上面代码，<code>bar</code>引用了<code>foo</code>函数，再调用时，是在全局上下文执行的，所以<code>this</code>绑定到全局对象上</p>
<h3 id="显示绑定"><a href="#显示绑定" class="headerlink" title="显示绑定"></a>显示绑定</h3><pre><code>function foo() {
  console.log(this.a)
}

var obj = {
  a: 2,
  foo: foo
}

foo.call(obj) // 2
</code></pre><p>上面代码，强制把<code>this</code>绑定到<code>obj</code>上</p>
<h4 id="硬绑定："><a href="#硬绑定：" class="headerlink" title="硬绑定："></a>硬绑定：</h4><pre><code>function foo() {
  console.log(this.a)
}

var obj = {
  a: 2,
  foo: foo
}

var bar = function() {
  foo.call(obj)
}

bar() // 2
setTimeout(bar, 100) // 2
bar.call(window) // 2
</code></pre><p>上面代码，在<code>bar</code>函数内部，直接调用<code>foo.call(obj)</code>，所以无论<code>bar</code>在哪里调用，<code>foo</code>的上下文都是<code>obj</code></p>
<h3 id="new绑定，使用new来调用函数时，会发生以下操作："><a href="#new绑定，使用new来调用函数时，会发生以下操作：" class="headerlink" title="new绑定，使用new来调用函数时，会发生以下操作："></a>new绑定，使用new来调用函数时，会发生以下操作：</h3><ol>
<li>创建一个新的对象</li>
<li>这个新对象会被执行到<code>[[Prototype]]</code>连接</li>
<li>这个新对象会绑定到函数调用的this</li>
<li><p>如果函数没有返回其他对象，那么<code>new</code>后会返回这个新对象</p>
<p> function foo(a) {<br>   this.a = a<br> }</p>
<p> var bar = new foo(2)<br> console.log(bar.a) // 2</p>
</li>
</ol>
<h3 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h3><p>默认绑定是最低级的</p>
<p>显式大于隐式</p>
<p>new大于隐式</p>
<p>显示绑定后的对象，new一个新的实例，<code>this</code>是指向新的实例</p>
<h3 id="绑定例外"><a href="#绑定例外" class="headerlink" title="绑定例外"></a>绑定例外</h3><p><code>foo.call(null)</code>, 会触发默认绑定</p>
<h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><p>根据外层作用域来判断<code>this</code>的指向</p>
<h2 id="2-3-对象"><a href="#2-3-对象" class="headerlink" title="2.3 对象"></a>2.3 对象</h2><h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><p>在<code>js</code>中，有六种基本类型：</p>
<ul>
<li>string</li>
<li>number</li>
<li>boolean</li>
<li>null</li>
<li>undefined</li>
<li>object</li>
</ul>
<p>为什么<code>typeof null</code>也是’object’呢？原理：不同的对象在底层都表示为二进制，在<code>js</code>中，前三位为<code>0</code>，判断为<code>object</code>，而<code>null</code>的二进制全为0，所以才会出现<code>object</code></p>
<p>基本类型都有其内置函数</p>
<h3 id="复制对象"><a href="#复制对象" class="headerlink" title="复制对象"></a>复制对象</h3><p>有浅拷贝和深拷贝</p>
<h4 id="浅拷贝"><a href="#浅拷贝" class="headerlink" title="浅拷贝"></a>浅拷贝</h4><p>基本类型值会复制，而对象，则会引用</p>
<h4 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h4><p>对象，把每一层的值，复制到新的对象里，如果是数组和对象，就会遍历它，一个个的复制</p>
<p><code>JSON.parse(JSON.stringify(data))</code>，粗暴的复制</p>
<h3 id="属性描述符"><a href="#属性描述符" class="headerlink" title="属性描述符"></a>属性描述符</h3><pre><code>var my = {
  a: 2
}
Object.getOwnPropertyDescriptor(my, &apos;1&apos;)
// {
//  value: 2,
//  writable: true,  可写
//  enumerable: true,  可枚举
//  configurable: true  可配置
// }
</code></pre><p>使用<code>getOwnPropertyDescriptor</code>，就能获取到这几个属性描述符</p>
<p>我们可以使用<code>defineProperty</code>来设置这4个值</p>
<pre><code>var my = {}
Object.getOwnPropertyDescriptor(my, &apos;a&apos;, {
 value: 2,
 writable: true,  可写
 enumerable: true,  可枚举
 configurable: true  可配置
})
</code></pre><h4 id="writable"><a href="#writable" class="headerlink" title="writable"></a>writable</h4><p>设置为<code>false</code>，就不能再修改这个对象，修改了也会无效，严格模式下回报错</p>
<h4 id="enumerable"><a href="#enumerable" class="headerlink" title="enumerable"></a>enumerable</h4><p>设置为<code>false</code>，<code>for..in</code>就不会枚举到此属性</p>
<h4 id="configurable"><a href="#configurable" class="headerlink" title="configurable"></a>configurable</h4><p>设置为<code>false</code>,不可配置，就不能设置这四个属性</p>
<h3 id="Getter-and-Setter"><a href="#Getter-and-Setter" class="headerlink" title="Getter and Setter"></a>Getter and Setter</h3><p><code>Getter</code> 和 <code>Setter</code> 是一个隐藏函数，在获取值和设置值的时候，会触发这个函数</p>
<p>当一个熟悉定义了<code>Getter</code> 和 <code>Setter</code> ，就会被定义为“访问描述符”</p>
<pre><code>var myO = {
  get a() {
    return this._a_
  },
  set a(val) {
    this._a_ = val
  }
}
// 或者使用defineProperty定义
Object.defineProperty(myO, b, {
  get: function() {
    return this.a * 2
  },
  enumerable: true
})
</code></pre><h3 id="存在性"><a href="#存在性" class="headerlink" title="存在性"></a>存在性</h3><p>判断属性值是 <code>undefined</code> 还是没有这个属性</p>
<pre><code>var myO = {
  a: 2
}
(&quot;a&quot; in myO) // true
(&quot;b&quot; in myO) // false
myO.hasOwnProperty(&quot;a&quot;) // true
myO.hasOwnProperty(&quot;b&quot;) // false
</code></pre><p><code>in</code> 操作符会检查属性是否在对象和原型链中，而 <code>hasOwnProperty</code> 不会检查原型链</p>
<p>使用获取、检查属性的方法适合，要确认是否会检查原型链</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/02/technology/多页面配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rni-L">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/02/technology/多页面配置/" itemprop="url">多页面配置</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-02T17:30:20+08:00">
                2017-09-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/教程/" itemprop="url" rel="index">
                    <span itemprop="name">教程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/09/02/technology/多页面配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/09/02/technology/多页面配置/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/09/02/technology/多页面配置/" class="leancloud_visitors" data-flag-title="多页面配置">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>这个主要是说明express + gulp的配置，重点在gulp，因为nodejs我也不怎么会</p>
</blockquote>
<h2 id="关键词"><a href="#关键词" class="headerlink" title="关键词"></a>关键词</h2><p>nodejs: 后端</p>
<p>express: nodejs框架</p>
<p>pug(jade): nodejs模板</p>
<p>mongodb: 数据库</p>
<p>lowdb: 数据库</p>
<p>gulp：编译工具</p>
<p>browser-sync: 自动刷新页面</p>
<p>browserify: 转换es6代码</p>
<h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><p><code>clone</code>项目</p>
<p><code>npm i</code>  安装依赖</p>
<p><code>gulp build</code>  生成静态文件</p>
<p><code>gulp watch</code>  进行开发</p>
<hr>
<h2 id="gulp"><a href="#gulp" class="headerlink" title="gulp"></a>gulp</h2><p><a href="http://www.gulpjs.com.cn/" target="_blank" rel="external">gulp中文文档</a></p>
<h3 id="gulp语法"><a href="#gulp语法" class="headerlink" title="gulp语法"></a>gulp语法</h3><p><code>gulp</code>是基于<strong>流</strong>进行操作的</p>
<p>而“流”，是数据的集合可以通过<code>pipe</code>方法，对上一个处理好的数据传递到下一个要处理的位置上</p>
<pre><code>gulp.src(&apos;main.js&apos;).pipe(uglify())
</code></pre><p>上面这一行代码，<code>gulp</code>通过<code>src</code>的方法获取<code>main.js</code>的流数据，通过<code>pipe</code>方法，把数据传递给<code>uglify</code>方法并执行</p>
<p><a href="http://nodejs.cn/api/stream.html" target="_blank" rel="external">nodejs官方文档</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/24432941" target="_blank" rel="external">Node.js流的解析</a></p>
<p><code>gulp</code>的方法，官方文档就给出了4个：src, task, dest, watch</p>
<h4 id="gulp-src-globs-options"><a href="#gulp-src-globs-options" class="headerlink" title="gulp.src(globs[, options])"></a>gulp.src(globs[, options])</h4><p>可以接受两个参数，第一个参数必选，可以是字符串或者数组。第一个参数用来匹配相应的文件</p>
<pre><code>// 这里会匹配&quot;src/js&quot;下面的所有.js文件
gulp.src(&apos;./src/js/*.js&apos;)

// 这里会匹配&quot;src/js&quot; 和 &quot;src/test&quot;下面的所有.js文件
gulp.src([&apos;./src/js/*.js&apos;, &apos;.s/src/test/*.js&apos;])
</code></pre><p><a href="https://github.com/isaacs/node-glob" target="_blank" rel="external">这里有很多匹配的规则</a></p>
<p>第二个参数是<code>options</code>，选择配置等，详细看<code>gulp</code>文档</p>
<h4 id="gulp-task-name-deps-fn"><a href="#gulp-task-name-deps-fn" class="headerlink" title="gulp.task(name[, deps], fn)"></a>gulp.task(name[, deps], fn)</h4><p>可以接受三个参数，第一个参数是字符串，声明这个任务的名字</p>
<p>第二个参数是数组，可选，在这个<code>fn</code>前，要执行的任务</p>
<p>第三个参数回调函数，必选，定义这个任务要干嘛</p>
<pre><code>gulp.task(&apos;say&apos;, function() {
  // ...
  console.log(&apos;say&apos;)
})
// 在执行&apos;hello&apos;任务之前，会先执行&apos;say&apos;任务
gulp.task(&apos;hello&apos;, [&apos;say&apos;], function(){
  // ...
  console.log(&apos;hello&apos;)
})
// 执行任务
gulp hello
// 终端就会打印出两行
...
say
...
hello
</code></pre><p><img src="./images/gulp1.jpg" alt=""></p>
<p><code>gulp.task</code>就是定义一个任务</p>
<h4 id="gulp-dest-path-options"><a href="#gulp-dest-path-options" class="headerlink" title="gulp.dest(path[, options])"></a>gulp.dest(path[, options])</h4><p>可以接受两个参数，第一个参数<code>path</code>，输出的路径</p>
<p>第二个参数配置选项，详情看<code>gulp</code>文档</p>
<p><code>gulp.dest</code>会把流数据，生成一个新的文件，如果指定的路径文件夹不存在，就会自动创建</p>
<pre><code>// 比如我将es6的代码转为es5后，最终输出到&apos;/dist/&apos;目录下
gulp.src(&apos;index.js&apos;)
    .pipe(babel())
    .......
    .pipe(gulp.dest(&apos;./dist/&apos;))
</code></pre><p><code>gulp.dest</code>就是指定文件输出到哪里</p>
<h4 id="gulp-watch"><a href="#gulp-watch" class="headerlink" title="gulp.watch()"></a>gulp.watch()</h4><p><code>gulp.watch</code>就是监听文件，当文件发生变化后，执行你定义好的操作</p>
<pre><code>// 监听&apos;js&apos;文件夹下面的所有.js文件 和 &apos;js&apos;文件夹中的子级文件夹的下面所有的.js文件，当这些文件变化后，执行定义好的&apos;js&apos;任务
gulp.watch([&apos;./js/*.js&apos;, &apos;./js/*/*.js&apos;], [&apos;js&apos;])

// 执行回调函数
gulp.watch([&apos;*.js&apos;], function(e) {
  console.log(e)
})
</code></pre><p><code>gulp.watch</code>还有其他一些参数配置，详情看<code>gulp</code>官方文档</p>
<h3 id="gulp插件"><a href="#gulp插件" class="headerlink" title="gulp插件"></a>gulp插件</h3><h4 id="js"><a href="#js" class="headerlink" title="js"></a>js</h4><ul>
<li><p>babelify</p>
<p>解析es6代码</p>
</li>
<li><p>browerify</p>
<p>解析<code>module</code>语法为AMD或CMD</p>
</li>
<li><p>vinyl-source-stream, vinyl-buffer</p>
<p>将常规流转换为包含Stream的vinyl对象，再转为Buffer，大概的作用是配合browerify一起使用  </p>
</li>
<li><p>gulp-uglify</p>
<p>压缩js文件</p>
</li>
</ul>
<h4 id="css"><a href="#css" class="headerlink" title="css"></a>css</h4><ul>
<li><p>gulp-sass/gulp-less</p>
<p>解析scss/less文件</p>
</li>
<li><p>gulp-clean-css</p>
<p><a href="https://github.com/jakubpawlowicz/clean-css#how-to-use-clean-css-api" target="_blank" rel="external">https://github.com/jakubpawlowicz/clean-css#how-to-use-clean-css-api</a></p>
<p>打包处理css文件</p>
</li>
<li><p>gulp-autoprefixer</p>
<p>自动添加css前缀</p>
</li>
</ul>
<h4 id="image"><a href="#image" class="headerlink" title="image"></a>image</h4><ul>
<li><p>gulp-imagemin</p>
<p>压缩图片</p>
</li>
</ul>
<h4 id="其他工具"><a href="#其他工具" class="headerlink" title="其他工具"></a>其他工具</h4><ul>
<li><p>gulp-sourcemaps</p>
<p><code>es6</code>的代码，转译成可执行的代码后，是非常难看的，这样不利于我们<code>debug</code>，这个插件可以告诉你错误的代码在哪一行</p>
</li>
<li><p>gulp-plumber</p>
<p>如果js或css发生了语法错误的话，<code>gulp</code>会停止运行的，使用了<code>gulp-plumber</code>之后，错误会显示在终端，而且大部分的错误不会使<code>gulp</code>停止运行。这个插件可以用于<code>js</code>, <code>css</code>, <code>es-lint</code>都可以。</p>
</li>
<li><p>gulp-notify</p>
<p>在终端打印信息</p>
</li>
<li><p>browser-sync</p>
<p>自动刷新工具，监测文件变化，从而自动刷新，<code>css</code>更新的话，会直接插入新的<code>css</code>，不会直接更新。而且可以带起代理，服务</p>
</li>
</ul>
<h3 id="这份配置文件，实现了什么功能"><a href="#这份配置文件，实现了什么功能" class="headerlink" title="这份配置文件，实现了什么功能"></a>这份配置文件，实现了什么功能</h3><ol>
<li><p>可以使用es7, es6的语法，自动压缩、合并js文件</p>
</li>
<li><p>可以使用less和sass，添加前缀，压缩css文件</p>
</li>
<li><p>文件变化，自动刷新页面</p>
</li>
<li><p>es-lint</p>
</li>
<li><p>压缩图片大小</p>
</li>
</ol>
<p>前端的配置，这里是使用<code>gulp</code>完成一系列的任务，<code>gulp</code>的使用，可以自定义的进行操作，最终我们只需要关注打包之后的文件就可以了</p>
<p>后续再看看如何增加版本号、hash值这些</p>
<h3 id="nodejs"><a href="#nodejs" class="headerlink" title="nodejs"></a>nodejs</h3><p>使用<code>pug(jade)</code>模板，进行服务端渲染。</p>
<p>默认配置了lowdb和mongodb，使用哪一个，在<code>app.js</code>调用就好</p>
<h4 id="database"><a href="#database" class="headerlink" title="database"></a>database</h4><p>lowdb是基于操作<code>.json</code>文件的，所有的数据存储在一个<code>.json</code>文件上，简单易上手，无脑配置，如果数据量大，性能会不好</p>
<p>mongodb是一种NoSQL(Not only SQL)，不是关系型数据库，以<code>json</code>的格式存储数据，但不是操作<code>.json</code>文件，数据文件是二进制的。相对lowdb会复杂点，但还是容易上手</p>
<h4 id="关系型数据库和非关系型数据库的区别"><a href="#关系型数据库和非关系型数据库的区别" class="headerlink" title="关系型数据库和非关系型数据库的区别"></a>关系型数据库和非关系型数据库的区别</h4><p>RDBMS </p>
<ul>
<li><p>高度组织化结构化数据 </p>
</li>
<li><p>结构化查询语言（SQL） (SQL) </p>
</li>
<li><p>数据和关系都存储在单独的表中。 </p>
</li>
<li><p>数据操纵语言，数据定义语言 </p>
</li>
<li><p>严格的一致性</p>
</li>
<li><p>基础事务</p>
</li>
</ul>
<p>NoSQL </p>
<ul>
<li><p>代表着不仅仅是SQL</p>
</li>
<li><p>没有声明性查询语言</p>
</li>
<li><p>没有预定义的模式</p>
</li>
</ul>
<p>-键 - 值对存储，列存储，文档存储，图形数据库</p>
<ul>
<li><p>最终一致性，而非ACID属性</p>
</li>
<li><p>非结构化和不可预知的数据</p>
</li>
<li><p>CAP定理 </p>
</li>
<li><p>高性能，高可用性和可伸缩性</p>
</li>
</ul>
<h4 id="mongoose"><a href="#mongoose" class="headerlink" title="mongoose"></a>mongoose</h4><p>mongoose是基于mongodb封装好的一个对象模型库，封装了一些方法，使我们更加规范的去操作数据库</p>
<h2 id="文件格式"><a href="#文件格式" class="headerlink" title="文件格式"></a>文件格式</h2><pre><code>+---lib                      ----    数据库文件        
|   +---lowdb                ----                                      
|   |                        ----          
|   \---mongodb              ----                                      
|                            ----      
+---logs                     ----    日志文件
|                            ----
+---public                   ----    前端打包后的文件   
|   +---dist                 ----                 
|   |   +---css              ----                    
|   |   \---js               ----                   
|   +---img                  ----                
|   \---lib                  ----    前端公共库            
+---routes                   ----    后端路由                   
|                            ----      
+---src                      ----    前端静态文件      
|   +---css                  ----                                        
|   |                        ----          
|   +---img                  ----                                     
|   |                        ----          
|   \---js                   ----                                   
|                            ----      
+---util                     ----    后端工具文件                                
|                            ----      
\---views                    ----    前端模板文件       
|   |   404.pug              ----                    
|   |   error.pug            ----                      
|   |   index.pug            ----                      
|   |   layout.pug           ----                       
|   |                        ----                          
|   .babelrc                 ----                 
|   .eslintrc                ----                  
|   .gitignore               ----     入口文件             
|   app.js                   ----               
|   config.example.js        ----     配置文件                         
|   gulpfile.js              ----                    
|   package.json             ----                     
|   README.md                ----                  
|
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/24/recording/git操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Rni-L">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/logo.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/24/recording/git操作/" itemprop="url">git操作</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-24T23:56:01+08:00">
                2017-08-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/记录/" itemprop="url" rel="index">
                    <span itemprop="name">记录</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/08/24/recording/git操作/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/08/24/recording/git操作/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/08/24/recording/git操作/" class="leancloud_visitors" data-flag-title="git操作">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="git日常操作"><a href="#git日常操作" class="headerlink" title="git日常操作"></a>git日常操作</h1><ul>
<li>删除：git rm</li>
<li>删除文件夹： git rm -r</li>
</ul>
<h2 id="打标签"><a href="#打标签" class="headerlink" title="打标签"></a>打标签</h2><ul>
<li>查看标签： git tag</li>
<li>新建标签： git tag -a v1.0 -m ‘…’</li>
<li>推送标签： git push origin v1.0</li>
</ul>
<h2 id="回滚"><a href="#回滚" class="headerlink" title="回滚"></a>回滚</h2><ul>
<li>回滚：git revert</li>
<li>回滚报错取消：git revert –abort</li>
</ul>
<p>git revert回滚操作，只能一级一级的回滚，不能跳级回滚</p>
<h2 id="忽略文件"><a href="#忽略文件" class="headerlink" title="忽略文件"></a>忽略文件</h2><p>.gitignore</p>
<p>如果要忽略某个原本已经在仓库的文件，要先删除它才行</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/logo.gif"
               alt="Rni-L" />
          <p class="site-author-name" itemprop="name">Rni-L</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">25</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/yiiouo" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Rni-L</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  

    
      <script id="dsq-count-scr" src="https://https-yiiouo-github-io.disqus.com/count.js" async></script>
    

    

  











  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("vD9lHLi5QOmwQClMGaq1YWsW-gzGzoHsz", "O9GPrsAJNYIaQClj8yNKSrFH");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

  

</body>
</html>
